import{r as s,b as M,j as i}from"./app-DqMOGD98.js";import{B as j}from"./button-CnCxC_fs.js";import{D as Q,a as T,b as W}from"./drawer-CLiudX9t.js";import{CityPropertyUnitSelector as X}from"./CityPropertyUnitSelector-DAYYk9iq.js";import{ApplicantInformationSection as Y}from"./ApplicantInformationSection-0L236VTS.js";import{StatusAndDateSection as Z}from"./StatusAndDateSection-K__w36dA.js";import{AdditionalDetailsSection as $}from"./AdditionalDetailsSection-DOjuHjPM.js";import"./app-Dca6SbuN.js";import"./index-BywuZfe1.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-Djaw7FEN.js";import"./index-CE-j_Hk-.js";import"./index-TpMpjpzk.js";import"./index-DV4B2SfL.js";import"./index-CIOEicCU.js";import"./index-D-mU1EC4.js";import"./x-yklQ_FSb.js";import"./createLucideIcon-YTrgT1D8.js";import"./label-CYMNIGLH.js";import"./popover-XOewc--E.js";import"./index-B550RzFm.js";import"./command-BQtaQ7wa.js";import"./search-DmG9ZvIp.js";import"./chevrons-up-down-B3QdoLm1.js";import"./check-DearYqlO.js";import"./input-CHeP_7PN.js";import"./select-CcLqZ2DM.js";import"./index-Dc_FVRD7.js";import"./index-Dtsi8hpy.js";import"./index-BLBWFuLc.js";import"./index-BfJTGFlI.js";import"./chevron-down-CVFkLqo9.js";import"./chevron-up-D2gF9iAP.js";import"./application-CnwOiERd.js";import"./calendar-B935ji8J.js";import"./format-DUNHsrA7.js";import"./chevron-left-ge3DLFDW.js";import"./chevron-right-B1lMLKBg.js";import"./radioGroup-D2Ap-vWb.js";import"./calendar-DgXDA8Yw.js";import"./file-text-DZtHCDd-.js";function Ht({cities:I,properties:_,units:C,open:A,onOpenChange:c,onSuccess:P,currentFilters:l,perPage:D,page:N}){const d=s.useRef(null),[u,n]=s.useState({}),[y,b]=s.useState(null),[v,f]=s.useState(null),[w,h]=s.useState([]),[E,p]=s.useState([]),{data:a,setData:r,post:U,processing:g,errors:m,reset:R,clearErrors:V,transform:k}=M({unit_id:null,name:"",co_signer:"",status:"",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]}),S=()=>{R(),V(),n({}),b(null),f(null),h([]),p([]),r({unit_id:null,name:"",co_signer:"",status:"",applicant_applied_from:"",date:"",stage_in_progress:"",notes:"",attachments:[]}),d.current&&(d.current.value="")},B=t=>{const e=parseInt(t);b(e),f(null),r("unit_id",null),n(o=>({...o,city:void 0,property:void 0,unit:void 0})),_[e]?h(_[e]):h([]),p([])},F=t=>{const e=parseInt(t);f(e),r("unit_id",null),n(o=>({...o,property:void 0,unit:void 0})),C[e]?p(C[e]):p([])},z=t=>{const e=parseInt(t);r("unit_id",e),n(o=>({...o,unit:void 0}))},q=t=>{r("name",t),n(e=>({...e,name:void 0}))},G=t=>{r("co_signer",t)},H=t=>{r("applicant_applied_from",t)},J=t=>{r("status",t),n(e=>({...e,status:void 0}))},x=t=>{t.preventDefault(),n({});let e=!1;const o={};if(y||(o.city="Please select a city before submitting the form.",e=!0),v||(o.property="Please select a property before submitting the form.",e=!0),a.unit_id||(o.unit="Please select a unit before submitting the form.",e=!0),(!a.name||a.name.trim()==="")&&(o.name="Please enter a name before submitting the form.",e=!0),(!a.status||a.status.trim()==="")&&(o.status="Please select a status before submitting the form.",e=!0),e){n(o);return}k(L=>({...L,filter_city:l.city||"",filter_property:l.property||"",filter_unit:l.unit||"",filter_name:l.name||"",filter_applicant_applied_from:l.applicant_applied_from||"",per_page:D,page:N})),U(route("applications.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{S(),c(!1),P?.()}})},K=()=>{S(),c(!1)};return i.jsx(Q,{open:A,onOpenChange:c,modal:!1,children:i.jsx(T,{size:"half",title:"Create New Application",children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(X,{cities:I,selectedCityId:y,selectedPropertyId:v,availableProperties:w,availableUnits:E,unitId:a.unit_id,onCityChange:B,onPropertyChange:F,onUnitChange:z,errors:m,validationErrors:u}),i.jsx(Y,{name:a.name,coSigner:a.co_signer,applicantAppliedFrom:a.applicant_applied_from,onNameChange:q,onCoSignerChange:G,onApplicantAppliedFromChange:H,errors:m,validationErrors:u}),i.jsx(Z,{status:a.status,date:a.date,onStatusChange:J,onDateChange:t=>r("date",t),errors:m,validationErrors:u}),i.jsx($,{stageInProgress:a.stage_in_progress,notes:a.notes,attachments:a.attachments,onStageInProgressChange:t=>r("stage_in_progress",t),onNotesChange:t=>r("notes",t),onAttachmentsChange:t=>r("attachments",t),fileInputRef:d,errors:m})]})}),i.jsx(W,{children:i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(j,{type:"button",variant:"outline",onClick:K,disabled:g,children:"Cancel"}),i.jsx(j,{type:"submit",onClick:x,disabled:g,children:g?"Creating...":"Create Application"})]})})]})})})}export{Ht as default};
