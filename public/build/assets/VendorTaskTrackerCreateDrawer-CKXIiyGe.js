import{r as s,u as ae,j as t}from"./app-D539PDEN.js";import{B as F}from"./button--IN0CSyb.js";import{D as ie,a as re,b as oe}from"./drawer-BOU8hUx7.js";import de from"./CitySection-DH8UK6pl.js";import le from"./PropertySection-DCvxvrIC.js";import ce from"./UnitSection-DAQu-uQ4.js";import ue from"./VendorSection-BnvI92f0.js";import me from"./TaskSubmissionDateSection-DC8L1HQ-.js";import fe from"./ScheduledVisitsSection-Dxc_0KuW.js";import _e from"./TaskEndingDateSection-60L8HNCJ.js";import he from"./AssignedTasksSection-CrszBmFv.js";import ge from"./NotesSection-DpUICXrd.js";import pe from"./StatusSection-BCgD3jxR.js";import ke from"./UrgencySection--3t3Yeml.js";import"./app-DvnMLx2o.js";import"./index-CituRSkQ.js";import"./utils-CBfrqCZ4.js";import"./index-MQL96Sqq.js";import"./index-BA2VIff1.js";import"./index-D9RoX9VL.js";import"./index-Coh7aVBC.js";import"./index-DECShoH4.js";import"./index-u_jnU6es.js";import"./x-DO94m97V.js";import"./createLucideIcon-4b2xxMBa.js";import"./label-D-ManEYT.js";import"./popover-uWV6s5Ev.js";import"./index-BtSfnK06.js";import"./command-CjlHw1Dl.js";import"./search-Dil3k9X7.js";import"./chevrons-up-down-28SbtDvw.js";import"./check-tZNcpeuV.js";import"./calendar-CrKHAktI.js";import"./format-DUNHsrA7.js";import"./chevron-right-B8Ihb2tS.js";import"./chevron-down-B9OnTpGY.js";import"./calendar-pGwOw633.js";import"./radioGroup-Cwca0D5V.js";import"./index-BWOOmq3Y.js";import"./index-DnE1pg1s.js";function it({cities:z,vendors:q,propertiesByCity:R,unitsByProperty:j,filters:G,open:H,onOpenChange:E,onSuccess:J}){const p=s.useRef(null),k=s.useRef(null),b=s.useRef(null),v=s.useRef(null),S=s.useRef(null),[K,u]=s.useState(""),[L,d]=s.useState(""),[M,c]=s.useState(""),[Q,m]=s.useState(""),[W,f]=s.useState(""),[P,_]=s.useState([]),[X,h]=s.useState([]),[U,C]=s.useState([]),[D,T]=s.useState({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),y=(e,a)=>{T(l=>({...l,[e]:a}))},{data:n,setData:i,post:Y,processing:A,errors:r,reset:O,transform:Z}=ae({vendor_id:"",unit_id:"",task_submission_date:"",assigned_tasks:"",any_scheduled_visits:"",notes:"",task_ending_date:"",status:"",urgent:"No"}),[o,w]=s.useState(""),[I,x]=s.useState(""),[,g]=s.useState(""),[,V]=s.useState(""),$=e=>{w(e),x(""),g(""),V(""),i("unit_id",""),i("vendor_id",""),u(""),d(""),c(""),e?(R[e]?h(R[e]):h([]),C(q)):(h([]),C([])),_([])},B=e=>{x(e),g(""),i("unit_id",""),d(""),o&&e&&j[o]&&j[o][e]?_(j[o][e]):_([])},ee=e=>{const a=P.find(l=>l.id.toString()===e);a&&(g(a.unit_name),i("unit_id",e),d(""))},te=e=>{const a=U.find(l=>l.id.toString()===e);a&&(V(a.vendor_name),i("vendor_id",e),c(""))},se=e=>{i("assigned_tasks",e.target.value),f("")},N=e=>{e.preventDefault(),u(""),d(""),c(""),m(""),f("");let a=!1;(!o||o.trim()==="")&&(u("Please select a city before submitting the form."),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),a=!0),(!n.unit_id||n.unit_id.trim()==="")&&(d("Please select a unit before submitting the form."),k.current&&(k.current.focus(),k.current.scrollIntoView({behavior:"smooth",block:"center"})),a=!0),(!n.vendor_id||n.vendor_id.trim()==="")&&(c("Please select a vendor before submitting the form."),b.current&&(b.current.focus(),b.current.scrollIntoView({behavior:"smooth",block:"center"})),a=!0),(!n.task_submission_date||n.task_submission_date.trim()==="")&&(m("Please select a task submission date before submitting the form."),v.current&&(v.current.focus(),v.current.scrollIntoView({behavior:"smooth",block:"center"})),a=!0),(!n.assigned_tasks||n.assigned_tasks.trim()==="")&&(f("Please enter assigned tasks before submitting the form."),S.current&&(S.current.focus(),S.current.scrollIntoView({behavior:"smooth",block:"center"})),a=!0),!a&&(Z(l=>({...l,redirect_filters:{...G}})),Y(route("vendor-task-tracker.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{O(),w(""),x(""),g(""),V(""),u(""),d(""),c(""),m(""),f(""),_([]),h([]),C([]),T({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),E(!1),J?.()}}))},ne=()=>{O(),w(""),x(""),g(""),V(""),u(""),d(""),c(""),m(""),f(""),_([]),h([]),C([]),T({task_submission_date:!1,any_scheduled_visits:!1,task_ending_date:!1}),E(!1)};return t.jsx(ie,{open:H,onOpenChange:E,modal:!1,children:t.jsx(re,{size:"half",title:"Create New Vendor Task",children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1 overflow-auto p-6",children:t.jsxs("form",{onSubmit:N,className:"space-y-4",children:[t.jsx(de,{cities:z,selectedCity:o,onCityChange:$,cityRef:p,errors:r,validationError:K}),t.jsx(le,{availableProperties:X,selectedProperty:I,selectedCity:o,onPropertyChange:B}),t.jsx(ce,{availableUnits:P,selectedProperty:I,unitId:n.unit_id,onUnitChange:ee,unitRef:k,errors:r,validationError:L}),t.jsx(ue,{availableVendors:U,selectedCity:o,vendorId:n.vendor_id,onVendorChange:te,vendorRef:b,errors:r,validationError:M}),t.jsx(me,{taskSubmissionDate:n.task_submission_date,calendarOpen:D.task_submission_date,onCalendarOpenChange:e=>y("task_submission_date",e),onDateChange:e=>{i("task_submission_date",e),m("")},taskSubmissionDateRef:v,errors:r,validationError:Q}),t.jsx(fe,{scheduledVisits:n.any_scheduled_visits,calendarOpen:D.any_scheduled_visits,onCalendarOpenChange:e=>y("any_scheduled_visits",e),onDateChange:e=>i("any_scheduled_visits",e),errors:r}),t.jsx(_e,{taskEndingDate:n.task_ending_date,calendarOpen:D.task_ending_date,onCalendarOpenChange:e=>y("task_ending_date",e),onDateChange:e=>i("task_ending_date",e),errors:r}),t.jsx(he,{assignedTasks:n.assigned_tasks,onAssignedTasksChange:se,assignedTasksRef:S,errors:r,validationError:W}),t.jsx(ge,{notes:n.notes,onNotesChange:e=>i("notes",e.target.value),errors:r}),t.jsx(pe,{status:n.status,onStatusChange:e=>i("status",e),errors:r}),t.jsx(ke,{urgent:n.urgent,onUrgentChange:e=>i("urgent",e),errors:r})]})}),t.jsx(oe,{children:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(F,{type:"button",variant:"outline",onClick:ne,className:"flex-1",children:"Cancel"}),t.jsx(F,{type:"submit",onClick:N,disabled:A,className:"flex-1",children:A?"Creating...":"Create Task"})]})})]})})})}export{it as default};
