import{r as p,b as G,j as i,a as J}from"./app-DqMOGD98.js";import{B as k}from"./button-CnCxC_fs.js";import{D as K,a as M,b as O}from"./drawer-CLiudX9t.js";import{CascadingSelectionSection as Q}from"./CascadingSelectionSection-DT-2KZuY.js";import{SelectionSummary as X}from"./SelectionSummary-C7lA0P-2.js";import{StatusSection as Y}from"./StatusSection-B3FstJh8.js";import{DateSection as Z}from"./DateSection-DzkiVld7.js";import{NoticeTypeSection as tt}from"./NoticeTypeSection-BGbT9z1B.js";import{ExceptionSection as et}from"./ExceptionSection-4HQYqG8j.js";import{NoteSection as nt}from"./NoteSection-DBuiYyJ6.js";import{EvictionsSection as it}from"./EvictionsSection-186mC9el.js";import{AttorneySection as ot}from"./AttorneySection-DeICplkL.js";import{HearingDatesSection as at}from"./HearingDatesSection-gQORi9AW.js";import{EvictionPaymentPlanSection as rt}from"./EvictionPaymentPlanSection-mKXQ5dKs.js";import{IfLeftSection as st}from"./IfLeftSection-DRdsiMF7.js";import{WritDateSection as lt}from"./WritDateSection-CHmmf0jV.js";import{OtherTenantsSection as _t}from"./OtherTenantsSection-Dh088Sr9.js";import"./app-Dca6SbuN.js";import"./index-BywuZfe1.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./index-Djaw7FEN.js";import"./index-CE-j_Hk-.js";import"./index-TpMpjpzk.js";import"./index-DV4B2SfL.js";import"./index-CIOEicCU.js";import"./index-D-mU1EC4.js";import"./x-yklQ_FSb.js";import"./createLucideIcon-YTrgT1D8.js";import"./label-CYMNIGLH.js";import"./command-BQtaQ7wa.js";import"./search-DmG9ZvIp.js";import"./popover-XOewc--E.js";import"./index-B550RzFm.js";import"./chevrons-up-down-B3QdoLm1.js";import"./check-DearYqlO.js";import"./radioGroup-D2Ap-vWb.js";import"./index-Dtsi8hpy.js";import"./index-BfJTGFlI.js";import"./calendar-B935ji8J.js";import"./format-DUNHsrA7.js";import"./chevron-left-ge3DLFDW.js";import"./chevron-right-B1lMLKBg.js";import"./chevron-down-CVFkLqo9.js";import"./calendar-DgXDA8Yw.js";import"./select-CcLqZ2DM.js";import"./index-Dc_FVRD7.js";import"./index-BLBWFuLc.js";import"./chevron-up-D2gF9iAP.js";import"./input-CHeP_7PN.js";function re({record:e,cities:D,properties:f,units:d,tenants:u,notices:A,open:x,onOpenChange:g,onSuccess:B,queryParams:V={}}){const[$,_]=p.useState({}),[S,E]=p.useState(null),[C,j]=p.useState(null),[h,y]=p.useState(null),[w,P]=p.useState([]),[T,I]=p.useState([]),[b,v]=p.useState([]),m=t=>{if(!t||t.trim()==="")return"";try{const n=new Date(t);return isNaN(n.getTime())?"":n.toISOString().split("T")[0]}catch(n){return console.warn("Date formatting error:",n),""}},{data:s,setData:a,processing:U,errors:l}=G({tenant_id:e.tenant_id||null,status:e.status||"",date:m(e.date)||"",type_of_notice:e.type_of_notice||"",have_an_exception:e.have_an_exception||"",note:e.note||"",evictions:e.evictions||"",sent_to_atorney:e.sent_to_atorney||"",hearing_dates:m(e.hearing_dates)||"",evected_or_payment_plan:e.evected_or_payment_plan||"",if_left:e.if_left||"",writ_date:m(e.writ_date)||"",other_tenants:e.other_tenants||""});p.useEffect(()=>{if(e&&e.tenant_id&&x){const t=u.find(n=>n.id===e.tenant_id);if(t){const n=d.find(o=>o.id===t.unit_id);if(n){const o=f.find(r=>r.id===n.property_id);if(o){E(o.city_id);const r=f.filter(c=>c.city_id===o.city_id);P(r),j(o.id);const N=d.filter(c=>c.property_id===o.id);I(N),y(n.id);const q=u.filter(c=>c.unit_id===n.id);v(q)}}}}},[e,u,d,f,x]);const z=t=>{const n=parseInt(t);E(n),j(null),y(null),a("tenant_id",null),a("other_tenants","");const o=f.filter(r=>r.city_id===n);P(o),I([]),v([]),_(r=>({...r,city:"",property:"",unit:"",tenant:""}))},H=t=>{const n=parseInt(t);j(n),y(null),a("tenant_id",null),a("other_tenants","");const o=d.filter(r=>r.property_id===n);I(o),v([]),_(r=>({...r,property:"",unit:"",tenant:""}))},L=t=>{const n=parseInt(t);y(n),a("tenant_id",null),a("other_tenants","");const o=u.filter(r=>r.unit_id===n);v(o),_(r=>({...r,unit:"",tenant:""}))},R=t=>{const n=parseInt(t);a("tenant_id",n),_(o=>({...o,tenant:""}))},F=t=>{t.preventDefault(),_({});let n=!1;const o={};if(S||(o.city="Please select a city before submitting the form.",n=!0),C||(o.property="Please select a property before submitting the form.",n=!0),h||(o.unit="Please select a unit before submitting the form.",n=!0),s.tenant_id||(o.tenant="Please select a tenant before submitting the form.",n=!0),n){_(o);return}const r={...s,...V};J.put(`/notice_and_evictions/${e.id}`,r,{onSuccess:()=>{_({}),g(!1),B?.()},onError:N=>{console.log("Form submission errors:",N)}})},W=()=>{a({tenant_id:e.tenant_id||null,status:e.status||"",date:m(e.date)||"",type_of_notice:e.type_of_notice||"",have_an_exception:e.have_an_exception||"",note:e.note||"",evictions:e.evictions||"",sent_to_atorney:e.sent_to_atorney||"",hearing_dates:m(e.hearing_dates)||"",evected_or_payment_plan:e.evected_or_payment_plan||"",if_left:e.if_left||"",writ_date:m(e.writ_date)||"",other_tenants:e.other_tenants||""}),_({}),g(!1)};return i.jsx(K,{open:x,onOpenChange:g,modal:!1,children:i.jsx(M,{size:"half",title:`Edit Notice & Eviction (ID: ${e.id})`,children:i.jsxs("div",{className:"flex h-full flex-col",children:[i.jsx("div",{className:"flex-1 overflow-auto p-6",children:i.jsxs("form",{onSubmit:F,className:"space-y-4",children:[i.jsx(Q,{cities:D,filteredProperties:w,filteredUnits:T,filteredTenants:b,selectedCityId:S,selectedPropertyId:C,selectedUnitId:h,tenantId:s.tenant_id,onCityChange:z,onPropertyChange:H,onUnitChange:L,onTenantChange:R,validationErrors:$,errors:l}),i.jsx(X,{cities:D,filteredProperties:w,filteredUnits:T,filteredTenants:b,selectedCityId:S,selectedPropertyId:C,selectedUnitId:h,tenantId:s.tenant_id}),i.jsx(_t,{value:s.other_tenants,onChange:t=>a("other_tenants",t),error:l.other_tenants,tenants:b,disabled:!h}),i.jsx(Y,{value:s.status,onChange:t=>a("status",t),error:l.status}),i.jsx(Z,{value:s.date,onChange:t=>a("date",t),error:l.date}),i.jsx(tt,{value:s.type_of_notice,onChange:t=>a("type_of_notice",t),notices:A,error:l.type_of_notice}),i.jsx(et,{value:s.have_an_exception,onChange:t=>a("have_an_exception",t),error:l.have_an_exception}),i.jsx(nt,{value:s.note||"",onChange:t=>a("note",t),error:l.note}),i.jsx(it,{value:s.evictions||"",onChange:t=>a("evictions",t),error:l.evictions}),i.jsx(ot,{value:s.sent_to_atorney,onChange:t=>a("sent_to_atorney",t),error:l.sent_to_atorney}),i.jsx(at,{value:s.hearing_dates,onChange:t=>a("hearing_dates",t),error:l.hearing_dates}),i.jsx(rt,{value:s.evected_or_payment_plan,onChange:t=>a("evected_or_payment_plan",t),error:l.evected_or_payment_plan}),i.jsx(st,{value:s.if_left,onChange:t=>a("if_left",t),error:l.if_left}),i.jsx(lt,{value:s.writ_date,onChange:t=>a("writ_date",t),error:l.writ_date})]})}),i.jsx(O,{children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx(k,{type:"button",variant:"outline",onClick:W,className:"flex-1",children:"Cancel"}),i.jsx(k,{type:"submit",onClick:F,disabled:U,className:"flex-1",children:U?"Updating...":"Update Notice & Eviction"})]})})]})})})}export{re as default};
