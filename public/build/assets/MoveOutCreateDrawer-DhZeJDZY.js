import{r as i,b as B,j as r}from"./app-DqMOGD98.js";import{D as G,a as H,b as J}from"./drawer-CLiudX9t.js";import{B as P}from"./button-CnCxC_fs.js";import K from"./LocationSection-BQ4IuACW.js";import Q from"./DateFieldsSection-BeJA0690.js";import W from"./PropertyDetailsSection-C2xbqAdk.js";import X from"./StatusFieldsSection-u3Zyob8a.js";import"./app-Dca6SbuN.js";import"./index-Djaw7FEN.js";import"./index-BywuZfe1.js";import"./index-CE-j_Hk-.js";import"./index-TpMpjpzk.js";import"./index-DV4B2SfL.js";import"./index-CIOEicCU.js";import"./index-D-mU1EC4.js";import"./index-CdJFUDDL.js";import"./utils-CBfrqCZ4.js";import"./x-yklQ_FSb.js";import"./createLucideIcon-YTrgT1D8.js";import"./FormField-DfEkyFUG.js";import"./label-CYMNIGLH.js";import"./TextInputField-BAkNk8Bw.js";import"./input-CHeP_7PN.js";import"./popover-XOewc--E.js";import"./index-B550RzFm.js";import"./command-BQtaQ7wa.js";import"./search-DmG9ZvIp.js";import"./chevrons-up-down-B3QdoLm1.js";import"./check-DearYqlO.js";import"./DatePickerField-DQz8xdLS.js";import"./calendar-B935ji8J.js";import"./format-DUNHsrA7.js";import"./chevron-left-ge3DLFDW.js";import"./chevron-right-B1lMLKBg.js";import"./chevron-down-CVFkLqo9.js";import"./calendar-DgXDA8Yw.js";import"./RadioGroupField-0EWC7jJ3.js";import"./radioGroup-D2Ap-vWb.js";import"./index-Dtsi8hpy.js";import"./index-BfJTGFlI.js";import"./TextAreaField-DiS4-ENw.js";import"./textarea-Bttm1uXI.js";function Oe({cities:N,propertiesByCityId:y,unitsByPropertyId:g,open:R,onOpenChange:b,onSuccess:k,redirectContext:l}){const u=i.useRef(null),c=i.useRef(null),p=i.useRef(null),[I,o]=i.useState({city:"",property:"",unit:""}),[v,S]=i.useState(null),[C,f]=i.useState(null),[x,m]=i.useState(null),[E,h]=i.useState([]),[U,_]=i.useState([]),[V,F]=i.useState({move_out_date:!1,date_lease_ending_on_buildium:!1,date_utility_put_under_our_name:!1}),{data:s,setData:a,post:M,processing:j,errors:d,reset:T,transform:A}=B({unit_id:null,tenants:"",move_out_date:"",lease_status:"",date_lease_ending_on_buildium:"",keys_location:"",utilities_under_our_name:"",date_utility_put_under_our_name:"",walkthrough:"",all_the_devices_are_off:"",repairs:"",send_back_security_deposit:"",notes:"",cleaning:"",list_the_unit:"",renter:"",move_out_form:"",utility_type:""}),O=n=>{const e=parseInt(n);S(e),f(null),m(null),a("unit_id",null),o(t=>({...t,city:"",property:"",unit:""})),e&&y[e]?h(y[e]):h([]),_([])},z=n=>{const e=parseInt(n);f(e),m(null),a("unit_id",null),o(t=>({...t,property:"",unit:""})),e&&g[e]?_(g[e]):_([])},L=n=>{const e=parseInt(n);m(e),a("unit_id",e),o(t=>({...t,unit:""}))},q=n=>{F(e=>({...e,[n]:!e[n]}))},D=n=>{n.preventDefault(),o({city:"",property:"",unit:""});let e=!1;v||(o(t=>({...t,city:"Please select a city before submitting the form."})),u.current&&(u.current.focus(),u.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),C||(o(t=>({...t,property:"Please select a property before submitting the form."})),c.current&&(c.current.focus(),c.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),(!x||!s.unit_id)&&(o(t=>({...t,unit:"Please select a unit before submitting the form."})),p.current&&(p.current.focus(),p.current.scrollIntoView({behavior:"smooth",block:"center"})),e=!0),!e&&(A(t=>({...t,move_out_date:t.move_out_date?.trim()?t.move_out_date:null,date_lease_ending_on_buildium:t.date_lease_ending_on_buildium?.trim()?t.date_lease_ending_on_buildium:null,date_utility_put_under_our_name:t.date_utility_put_under_our_name?.trim()?t.date_utility_put_under_our_name:null,redirect_city:l?.city??null,redirect_property:l?.property??null,redirect_unit:l?.unit??null,redirect_page:l?.page??null,redirect_perPage:l?.perPage??null})),M(route("move-out.store"),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{w(),k?.()}}))},w=()=>{T(),S(null),f(null),m(null),o({city:"",property:"",unit:""}),h([]),_([]),b(!1)};return r.jsx(G,{open:R,onOpenChange:b,modal:!1,children:r.jsx(H,{size:"half",title:"Create New Move-Out Record",children:r.jsxs("div",{className:"flex h-full flex-col",children:[r.jsx("div",{className:"flex-1 overflow-auto p-6",children:r.jsxs("form",{onSubmit:D,className:"space-y-4",children:[r.jsx(K,{cities:N,availableProperties:E,availableUnits:U,selectedCity:v,selectedProperty:C,selectedUnit:x,validationErrors:I,cityRef:u,propertyRef:c,unitRef:p,onCityChange:O,onPropertyChange:z,onUnitChange:L,tenants:s.tenants,tenantsError:d.tenants,onTenantsChange:n=>a("tenants",n)}),r.jsx(Q,{data:s,errors:d,calendarStates:V,onCalendarToggle:q,onDataChange:a}),r.jsx(W,{data:s,errors:d,onDataChange:a}),r.jsx(X,{data:s,errors:d,onDataChange:a})]})}),r.jsx(J,{children:r.jsxs("div",{className:"flex gap-2 w-full",children:[r.jsx(P,{type:"button",variant:"outline",onClick:w,className:"flex-1",children:"Cancel"}),r.jsx(P,{type:"submit",onClick:D,disabled:j,className:"flex-1",children:j?"Creating...":"Create Move-Out Record"})]})})]})})})}export{Oe as default};
